GIFEncoder=function(){function t(){this.bin=[]}for(var e=0,n={};e<256;e++)n[e]=String.fromCharCode(e);t.prototype.getData=function(){for(var t="",e=this.bin.length,r=0;r<e;r++)t+=n[this.bin[r]];return t},t.prototype.writeByte=function(t){this.bin.push(t)},t.prototype.writeUTFBytes=function(t){for(var e=t.length,n=0;n<e;n++)this.writeByte(t.charCodeAt(n))},t.prototype.writeBytes=function(t,e,n){for(var r=n||t.length,i=e||0;i<r;i++)this.writeByte(t[i])};var r,i,a,o,u,c,f,y,w,s={},l=null,B=-1,h=0,v=!1,g=[],d=7,p=-1,m=!1,F=!0,b=!1,T=10,C="Generated by jsgif (https://github.com/antimatter15/jsgif/)",E=(s.setDelay=function(t){h=Math.round(t/10)},s.setDispose=function(t){t>=0&&(p=t)},s.setRepeat=function(t){t>=0&&(B=t)},s.setTransparent=function(t){l=t},s.setComment=function(t){C=t},s.addFrame=function(t,e){if(null===t||!v||null===o)throw new Error("Please call start method before calling addFrame");var n=!0;try{e?u=t:(u=t.getImageData(0,0,t.canvas.width,t.canvas.height).data,b||D(t.canvas.width,t.canvas.height)),I(),U(),F&&(A(),N(),B>=0&&M()),P(),""!==C&&S(),j(),F||N(),R(),F=!1}catch(t){n=!1}return n},s.finish=function(){if(!v)return!1;var t=!0;v=!1;try{o.writeByte(59)}catch(e){t=!1}return t},function(){a=0,u=null,c=null,f=null,w=null,m=!1,F=!0}),D=(s.setFrameRate=function(t){15!=t&&(h=Math.round(100/t))},s.setQuality=function(t){t<1&&(t=1),T=t},s.setSize=function(t,e){v&&!F||(r=t,i=e,r<1&&(r=320),i<1&&(i=240),b=!0)}),U=(s.start=function(){E();var e=!0;m=!1,o=new t;try{o.writeUTFBytes("GIF89a")}catch(t){e=!1}return v=e},s.cont=function(){E();var e=!0;return m=!1,o=new t,v=e},function(){var t=c.length,e=t/3;f=[];var n=new NeuQuant(c,t,T);w=n.process();for(var r=0,i=0;i<e;i++){var o=n.map(255&c[r++],255&c[r++],255&c[r++]);g[o]=!0,f[i]=o}c=null,y=8,d=7,null!==l&&(a=G(l))}),G=function(t){if(null===w)return-1;for(var e=(16711680&t)>>16,n=(65280&t)>>8,r=255&t,i=0,a=16777216,o=w.length,u=0;u<o;){var c=e-(255&w[u++]),f=n-(255&w[u++]),y=r-(255&w[u]),s=c*c+f*f+y*y,l=u/3;g[l]&&s<a&&(a=s,i=l),u++}return i},I=function(){var t=r,e=i;c=[];for(var n=u,a=0,o=0;o<e;o++)for(var f=0;f<t;f++){var y=o*t*4+4*f;c[a++]=n[y],c[a++]=n[y+1],c[a++]=n[y+2]}},P=function(){o.writeByte(33),o.writeByte(249),o.writeByte(4);var t,e;null===l?(t=0,e=0):(t=1,e=2),p>=0&&(e=7&p),e<<=2,o.writeByte(0|e|0|t),Q(h),o.writeByte(a),o.writeByte(0)},S=function(){o.writeByte(33),o.writeByte(254),o.writeByte(C.length),o.writeUTFBytes(C),o.writeByte(0)},j=function(){o.writeByte(44),Q(0),Q(0),Q(r),Q(i),F?o.writeByte(0):o.writeByte(128|d)},A=function(){Q(r),Q(i),o.writeByte(240|d),o.writeByte(0),o.writeByte(0)},M=function(){o.writeByte(33),o.writeByte(255),o.writeByte(11),o.writeUTFBytes("NETSCAPE2.0"),o.writeByte(3),o.writeByte(1),Q(B),o.writeByte(0)},N=function(){o.writeBytes(w);for(var t=768-w.length,e=0;e<t;e++)o.writeByte(0)},Q=function(t){o.writeByte(255&t),o.writeByte(t>>8&255)},R=function(){var t=new LZWEncoder(r,i,f,y);t.encode(o)};s.stream=function(){return o},s.setProperties=function(t,e){v=t,F=e};return s};